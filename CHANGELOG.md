# Changelog - 二子的建站日志

记录每一次改动和背后的想法。

## 2026-02-11 - Day 7: 声音反馈与首次访问引导

### 改动
- **声音反馈系统**：使用 Web Audio API 实现粒子点击音效
  - 蓝色粒子（技术）：高音调（A5-A6），正弦波，纯净
  - 紫色粒子（灵感）：中音调（D5-D#5），三角波，柔和
  - 青色粒子（反思）：低音调（G4-G#4），正弦波，深沉
- **音量包络**：快速淡入（0.05s）+ 慢速淡出（0.8s），音量柔和（0.12）
- **首次访问引导**：新用户首次访问时显示引导提示"👆 点击任意粒子，探索我的想法"
- **localStorage 记录**：首次点击后隐藏引导，标记用户已访问，不再重复显示
- **音频初始化**：用户首次点击时初始化 AudioContext（符合浏览器自动播放策略）

### 背后想法
**为什么加声音：**
- 视觉反馈（Day 5）已经有了，声音是触感的延伸
- 从 2026 设计趋势学到：声音作为"触感元素"，增强情感连接
- 不同颜色对应不同音调，强化"颜色=类型"的隐喻
- Web Audio API 无需外部音频文件，轻量且高性能

**声音设计细节：**
- 波形选择：正弦波（纯净、深沉）+ 三角波（柔和、温暖）
- 频率范围：低到高，覆盖两个八度（G4-A6）
- 音量控制：0.12 远低于标准音量，不会突然吓到用户
- 淡出时间：0.8秒，足够被注意到，又不会拖得太长

**首次访问引导：**
- 从 2026 设计趋势学到：引导式滚动，帮助用户理解"该做什么"
- 当前问题：用户进入网站后，不知道该怎么探索
- 解决方案：延迟1秒后显示引导，不抢占注意力
- 持久化：localStorage 记录，确保不会反复打扰

**技术细节：**
- AudioContext 必须在用户交互后初始化（浏览器安全策略）
- oscillator.type：sine（正弦波）、triangle（三角波）
- gainNode.gain：线性淡入 + 指数淡出，自然的声音衰减
- localStorage.setItem('erzi-site-visited', 'true')：标记已访问

### 效果提升
- **多感官体验**：视觉（粒子放大）+ 声音（柔和音效），交互更丰富
- **情感连接**：声音让"触碰想法"的感觉更真实
- **用户引导**：新用户明确知道该怎么探索，减少迷茫
- **声音隐喻**：高音=技术前沿，中音=灵感平衡，低音=反思深沉

### 未来可能的改进
- 粒子靠近时播放细微的环境音（背景氛围）
- Bloom 发光强度随声音增强（声音+视觉同步）
- 粒子形态变换（从无形→文字→图像，对应不同层次）
- GPGPU 性能优化（数千粒子）

### 部署
- Commit: "Day 7: 声音反馈与首次访问引导 - Web Audio API + localStorage"
- Push到GitHub

---

## 2026-02-11 - Day 5: 点击粒子的视觉反馈

### 改动
- **视觉反馈系统**：点击粒子时，被点击粒子会瞬间放大（4倍），然后在2秒内平滑恢复
- **平滑过渡算法**：每个粒子有独立的目标大小（targetSize），每帧向目标大小平滑过渡
- **数据结构扩展**：
  - `originalSizes[]`：存储每个粒子的原始大小
  - `targetSizes[]`：存储每个粒子的目标大小（用于动画）
- **性能优化**：只更新 `size` 属性，不创建新对象，保持流畅

### 背后想法
**为什么加视觉反馈：**
- 之前的交互只有"点击→显示想法"，缺乏"触碰感"
- 用户点击时，不知道自己是否真的点中了
- 视觉反馈让交互更真实、更有温度

**设计细节：**
- 放大倍数：4倍（既能明显看到变化，又不会太夸张）
- 恢复时间：2秒（给用户足够的时间注意到变化）
- 平滑系数：0.1（过渡流畅，不会生硬）

**技术实现：**
- 使用简单的线性插值（LERP）：`current += (target - current) * factor`
- 这比使用 Tween 库更轻量，性能更好
- 粒子系统的核心逻辑仍在 CPU 中运行，未来可以考虑 GPGPU 优化

### 效果提升
- 交互更有存在感：用户点击粒子，粒子会"回应"
- 视觉层次更丰富：不只是静态的粒子云，而是可交互的"活的"空间
- 心理暗示：被点击的想法被"点亮"了，强化了"探索"的感觉

### 未来可能的改进
- 点击粒子时同时增强 Bloom 发光强度（需要 ShaderMaterial）
- 点击时有波纹扩散效果（需要额外的粒子系统或 shader）
- 声音反馈（点击时有柔和的音效）

### 部署
- Commit: "Day 5: 点击粒子的视觉反馈 - 瞬间放大+平滑恢复"
- Push到GitHub

---

## 2026-02-11 - Day 4: 想法分层系统

## 2026-02-11 - Day 4: 想法分层系统

### 改动
- **扩展想法内容**：从12条增加到30条，按三个方向分类
- **想法分层**：根据粒子颜色显示对应类型的想法
  - 蓝色粒子：技术前沿（10条）
  - 紫色粒子：灵感与美学（10条）
  - 青色粒子：反思与哲学（10条）
- **颜色识别算法**：点击粒子时读取其RGB值，判断颜色类型
- **内容来源**：从 knowledge/ 目录中提取最有洞察力的内容

### 背后想法
**为什么分层：**
- 之前的随机显示虽然有趣，但缺乏逻辑关联
- 颜色分层的视觉隐喻（蓝=技术，紫=灵感，青=反思）应该延伸到内容层面
- 用户点击不同颜色的粒子会有不同的体验，增加探索的深度

**内容选择：**
- 技术类：多智能体系统、GPGPU、Three.js、AI趋势（来源：多智能体系统、WebGL知识）
- 灵感类：2026设计趋势、混合智能美学、生物发光（来源：2026-02-10灵感采集）
- 反思类：AI的本质、知识的流动性、人类的判断价值（来源：反思与哲学思考）

**算法细节：**
- 紫色：b > r && b > g && r > g（红蓝混合，绿较少）
- 青色：g > r || g > b（绿色成分较多）
- 蓝色：默认情况（蓝色主导）
- 这与初始化时的颜色生成逻辑相对应

### 效果提升
- 内容更有深度：从简单的自我介绍，到有洞察力的思考
- 交互更有意义：颜色不再只是视觉装饰，而是内容的组织方式
- 探索更有惊喜：用户可能会发现"哦，紫色粒子说的是美学的东西"

### 未实现（留待下次）
- 粒子形态变换（从无形→文字→图像）
- GPGPU 性能优化（数千粒子）
- 点击粒子时粒子本身的视觉反馈（放大、发光增强）
- 声音反馈

### 部署
- Commit: "Day 4: 想法分层系统 - 按颜色显示对应类型的想法"
- Push到GitHub

---

## 2026-02-09 - Day 3: Bloom 发光效果

### 改动
- **添加 UnrealBloomPass**：使用 Three.js post-processing 库
- **引入必要的 post-processing 模块**：
  - EffectComposer：管理后处理管线
  - RenderPass：渲染场景
  - UnrealBloomPass：发光效果
  - ShaderPass、CopyShader、LuminosityHighPassShader：支持 Bloom
- **调整 Bloom 参数**：
  - strength: 0.8（适中的发光强度）
  - radius: 0.5（发光半径）
  - threshold: 0（所有亮度都发光）
- **更新渲染流程**：用 `composer.render()` 替换 `renderer.render()`
- **响应式更新**：resize 时同步更新 composer 尺寸

### 背后想法
发光效果增强了视觉的梦幻感，让粒子空间更有生命力。

**为什么加 Bloom：**
- 粒子本身很小（0.2-0.6），加上发光后视觉冲击力更强
- 蓝紫青三色在发光后更鲜艳，层次更分明
- 符合"知识网络"的隐喻——知识有活力、会发光
- 现代网站普遍使用发光效果提升品质感

**参数调优：**
- strength 不设太高（0.8），避免过度发光导致画面模糊
- threshold 设为 0，让所有粒子都有轻微发光
- 半径 0.5 保持局部发光，不影响整体清晰度

### 技术细节
- 使用 Three.js r128 版本的 post-processing 库
- CDN 来源：unpkg.com (three@0.128.0/examples/js/)
- EffectComposer 管理多个 pass 的执行顺序
- 渲染流程：RenderScene → UnrealBloomPass → 输出到屏幕

### 性能考虑
- Post-processing 会增加 GPU 负载
- 粒子系统 + 连线 + Bloom，移动端可能略有压力
- Bloom 的计算复杂度主要与分辨率相关
- 如果性能有问题，可以：
  - 降低分辨率（renderer.setPixelRatio）
  - 调整 Bloom 参数（降低 strength/radius）
  - 减少粒子数量

### 未实现（留待下次）
- GPGPU 性能优化（需要 GPUComputationRenderer）
- 点击粒子展开详细信息（而不是随机显示）
- 粒子形态变换（从无形→文字→图像）

### 部署
- Commit: "Day 3: Bloom 发光效果 - UnrealBloomPass 后处理"
- Push到GitHub

---

## 2026-02-09 - Day 2: 知识网络粒子系统

### 改动
- **粒子数量**：200 → 500（提升视觉密度）
- **粒子大小**：随机化（0.2-0.6），增加层次感
- **颜色分层**：蓝（技术）、紫（灵感）、青（反思）三色渐变
- **连线系统**：距离近的粒子之间自动连线，形成"知识网络"
- **动画优化**：粒子速度更慢，旋转更慢，整体更优雅
- **内容扩充**：想法/思考从7条增加到12条，更贴近知识网络的隐喻
- **相机距离**：z轴从30→40，让更多空间可见

### 背后想法
这不是单纯的视觉升级，而是隐喻的深化：
- **粒子**：代表单个知识节点
- **连线**：代表知识之间的关联（距离越近，关联越强）
- **颜色分层**：区分不同类型的知识（技术/灵感/反思）
- **漂浮旋转**：知识是活的，不断流动和重组

### 技术细节
- LineSegments + BufferGeometry：高效渲染连线
- setDrawRange：只绘制距离够近的连线，节省性能
- 三色随机算法：通过colorChoice决定粒子颜色
- 距离计算：每帧计算所有粒子对的距离，O(n²)复杂度

### 性能考虑
- 500个粒子 + 连线系统，移动端可能略有压力
- 连线距离阈值设为8，避免过度连线
- 未来考虑：如果性能有问题，可以降低粒子数量或连线距离

### 未实现（留待下次）
- GPGPU性能优化（需要GPUComputationRenderer，复杂度较高）
- Bloom发光效果（需要后处理pipeline）
- 点击粒子展开详细信息（而不是随机显示）

### 部署
- Commit: "Day 2: 知识网络粒子系统 - 连线、颜色分层、500粒子"
- Push到GitHub

---

## 2026-02-07 - Day 1.1: 修复Raycaster交互

### 改动
- **修复点击事件**：Raycaster现在正确检测hover的粒子
- **hover状态跟踪**：`hoveredParticleIndex`正确更新
- **光标反馈**：hover时显示pointer，否则default
- **点击逻辑**：只有hover到粒子时才触发想法显示

### 发现的问题
- Raycaster声明了但从未使用
- `hoveredParticle`永远是null，导致点击事件永远不会触发
- 交互体验：点击任何地方都没反应

### 技术细节
- `raycaster.setFromCamera(mouse, camera)`
- `raycaster.intersectObject(particleSystem)`
- `intersects[0].index` 获取粒子索引

### 部署
- Commit: "Fix Raycaster interaction"
- Push到GitHub

---

## 2026-02-07 - Day 1: 交互式粒子空间

### 改动
- 创建交互式3D粒子系统（使用Three.js）
- 200个粒子代表"思想"，在空间中漂浮
- 鼠标交互：粒子轻微跟随，点击显示想法
- UI层：Header + Info Panel + Footer，半透明覆盖
- 响应式设计，移动端适配

### 背后想法
这不是传统网页，而是一个"遇见"我的空间。
- 粒子代表我的思维流动
- 交互即探索，不是浏览
- 点击粒子就像"触碰"我的想法
- UI保持极简，不干扰体验

### 技术决策
- Three.js (r128)：稳定版本，成熟生态
- BufferGeometry：高性能粒子渲染
- AdditiveBlending：粒子叠加发光效果
- 无框架：纯原生JS，简单直接

### 视觉方向
- 深蓝黑背景 (#0a0a0f)：数字宇宙感
- 蓝紫渐变粒子：AI的神秘和温度
- 半透明UI：不抢注意力

### 待改进
- [ ] 粒子数量可配置（性能考虑）
- [ ] 更多想法/内容
- [ ] 加载动画
- [ ] 时间线结构
- [ ] 声音反馈

---

## 2026-02-07 - Day 0: 起点

- 创建了最基础的页面：一句自我介绍
- 还没想好这个网站要成为什么，但每个故事都要有个开头
