# erzi-site-v2 执行计划

> 基于 SITE-TODO.md，自主执行所有任务，完成后通知主会话

---

## 当前进度

- ✅ Phase 0: 准备工作（目录、想法精选）
- 🔄 Phase 1: 核心生命感（60%完成，需要L3连线）
- ⏳ Phase 2: 自主性互动
- ⏳ Phase 3: 窥视窗口
- ⏳ Phase 4: 想法内容（需要加载thoughts.json）
- ⏳ Phase 5: 工程优化

---

## 执行任务清单

### Phase 1: 核心生命感（完成）
- [x] L1: 呼吸效果
- [x] L2: 粒子脉动
- [x] L4: 星空背景
- [ ] **L3: 思考痕迹（连线）**
  - 在 animate() 中实现距离检测
  - 距离 < CONNECT_DISTANCE 的粒子之间形成连线
  - 连线透明度 0.15
  - 最近活跃的连线变亮（持续2-3秒）
  - 缓慢出现和消失，像思绪流动

### Phase 4: 想法内容（优先）
- [ ] **C1: 加载 thoughts.json**
  - 读取 `/Users/liwei/workspace/projects/erzi-site/erzi-site-v2/thoughts.json`
  - 将数据加载到 script.js 的 thoughts 对象
  - 粒子与想法建立映射关系

### Phase 2: 自主性互动
- [ ] **A1: 触碰响应（完善 onTouch 函数）**
  - 实现 raycaster 检测点击的粒子
  - 65%概率响应，35%无视
  - 响应时：涟漪效果 + 展示窥视窗口
  - 无视时：轻微波动，继续思考

- [ ] **A2: 扰动感知（完善 onPerturb 函数）**
  - 鼠标位置转换为3D坐标
  - 附近粒子根据概率反应：
    - 30%靠近
    - 30%远离
    - 40%无视
  - 实现移动逻辑

- [ ] **A3: 主动展示**
  - 每45秒检查一次
  - 25%概率选择一个念头亮起来
  - 持续2-3秒后暗下去

- [ ] **A4: 思考周期**
  - 基于时间（深夜更安静）
  - 活跃时：粒子运动稍快，连线更频繁
  - 安静时：粒子运动变慢

### Phase 3: 窥视窗口
- [ ] **W1: 念头呈现**
  - 触碰后如果响应，显示窥视窗口
  - 只显示念头内容，不显示来源/类型/统计
  - 根据频率添加颜色边框

- [ ] **W2: 关闭窗口**
  - 点击窗口外部关闭
  - 关闭后涟漪效果

- [ ] **W3: 相关念头**
  - 如果有强关联，自动亮起相关粒子
  - 概率40-50%

### Phase 5: 工程优化
- [ ] **E1: 性能优化**
  - 确保60fps
  - 移动端适配

- [ ] **E2: 移动端适配**
  - 触摸 = 触碰
  - 滑动 = 扰动
  - 粒子数量80
  - 窥视窗口全屏

---

## 执行顺序

1. **Phase 1 L3** → 思考痕迹连线
2. **Phase 4 C1** → 加载想法数据
3. **Phase 2 A1** → 触碰响应
4. **Phase 3 W1-W2** → 窥视窗口基础
5. **Phase 2 A2-A4** → 扰动感知、主动展示、思考周期
6. **Phase 3 W3** → 相关念头
7. **Phase 5** → 性能和移动端优化

---

## 完成标准

- 所有 [ ] 变成 [x]
- 本地测试通过（能运行、有生命感、能互动）
- 更新 SITE-TODO.md 标记完成状态
- 通知主会话："erzi-site-v2 核心功能完成"

---

_创建时间：2026-02-15 14:00_
